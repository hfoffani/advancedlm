---
title: "Code Examples"
author: "herchu1"
date: "17 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Code Examples

R Markdown see <http://rmarkdown.rstudio.com>.

Setup **code**:

```{r}
data("mtcars")
head(mtcars)
y = mtcars$mpg
x = cbind(1, mtcars$wt, mtcars$hp)
head(x)
```

### Least squares.

Fit with least squares.

```{r}
solve( t(x) %*% x ) %*% t(x) %*% y
```

R does the same using `lm`

```{r}
coef( lm( mpg ~ wt + hp, data=mtcars ))
```


### Mean centered

```{r}
n = nrow(x)
I = diag(1, n)
H = matrix(1, n, n) / n

xc = (I - H) %*% x
```

Testing the result. Take the mean of all columns (axis 2).
Using `sweep` can be faster.

```{r}
apply(xc, 2, mean)
xc2 = sweep(x, 2, apply(x, 2, mean))
```

### Variance

Using linear algebra and comparing it with bundled R function `var`.

```{r}
vx = ( t(x) %*% (I - H) %*% x ) / (n-1)

round(vx, 6)
var(x)
```

